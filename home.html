<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Russian Phonetic Course</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: white;
        }
        
        .syllable-header {
            background: white;
            color: #2c3e50;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.5em;
            font-weight: bold;
        }
        
        .syllable-examples {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .syllable-group {
            text-align: center;
        }
        
        .syllable-text {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ecf0f1;
        }
        
        .word-with-image {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            color: #2c3e50;
        }
        
        .word-image {
            width: 120px;
            height: 120px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            border: 3px solid #ddd;
        }
        
        .word-text {
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
        }
        
        .sound-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .sound-card {
            background: white;
            color: #2c3e50;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }
        
        .sound-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: #3498db;
        }
        
        .sound-card.active {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .sound-letter {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .sound-example {
            font-size: 0.9em;
            opacity: 0.7;
        }
        
        .controls {
            text-align: center;
            margin: 40px 0;
        }
        
        .instruction {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.1em;
        }
        
        .play-btn {
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 2em;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
        }
        
        .play-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }
        
        .microphone-btn {
            background: #e67e22;
            color: white;
            border: none;
            border-radius: 50%;
            width: 100px;
            height: 100px;
            font-size: 2.5em;
            cursor: pointer;
            margin: 20px;
            transition: all 0.3s;
        }
        
        .microphone-btn.recording {
            background: #27ae60;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .feedback {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .feedback.error {
            background: rgba(231, 76, 60, 0.2);
            border-color: #e74c3c;
        }
        
        .hidden {
            display: none;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .nav-btn {
            background: #34495e;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background: #2c3e50;
        }
        
        .nav-btn:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>1 SYLLABLE - 1 TA</h1>
        </div>
        
        <div class="syllable-examples">
            <div class="syllable-group">
                <div class="syllable-text">–ú√Å–ú–ê –¢√Å-–¢–ê</div>
                <div class="word-with-image">
                    <div class="word-image">üë©‚Äçüëß</div>
                    <div class="word-text">–ú√Å–ú–ê</div>
                </div>
            </div>
            
            <div class="syllable-group">
                <div class="syllable-text">–¢–û–ú√Å–¢ –¢–ê-–¢√Å</div>
                <div class="word-with-image">
                    <div class="word-image">üçÖ</div>
                    <div class="word-text">–¢–û–ú√Å–¢</div>
                </div>
            </div>
            
            <div class="syllable-group">
                <div class="syllable-text">–ö–û–ú√â–¢–ê –¢–ê-–¢√Å-–¢–ê</div>
                <div class="word-with-image">
                    <div class="word-image">‚òÑÔ∏è</div>
                    <div class="word-text">–ö–û–ú√â–¢–ê</div>
                </div>
            </div>
        </div>
        
        <div class="syllable-header">
            Listen and repeat
        </div>
        
        <div class="instruction">
            <p>Click on each sound to hear it, then try to repeat it using the microphone</p>
        </div>
        
        <div class="sound-grid">
            <div class="sound-card" onclick="playSound('–ê')" data-sound="–ê">
                <div class="sound-letter">–ê</div>
                <div class="sound-example">–ö–ê-–¢–ê-–ú–ê</div>
            </div>
            <div class="sound-card" onclick="playSound('–ö')" data-sound="–ö">
                <div class="sound-letter">–ö</div>
            </div>
            <div class="sound-card" onclick="playSound('–ú')" data-sound="–ú">
                <div class="sound-letter">–ú</div>
            </div>
            <div class="sound-card" onclick="playSound('–¢')" data-sound="–¢">
                <div class="sound-letter">–¢</div>
            </div>
            <div class="sound-card" onclick="playSound('–û')" data-sound="–û">
                <div class="sound-letter">–û</div>
            </div>
            <div class="sound-card" onclick="playSound('–ï')" data-sound="–ï">
                <div class="sound-letter">–ï</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="play-btn" onclick="playCurrentSound()" title="Play current sound">üîä</button>
            <button id="micBtn" class="microphone-btn" onclick="startRecording()" title="Record your pronunciation">üé§</button>
        </div>
        
        <div id="feedback" class="feedback hidden">
            <p id="feedbackText"></p>
        </div>
        
        <div class="navigation">
            <button class="nav-btn" onclick="previousSound()">‚¨Ö Previous</button>
            <button class="nav-btn" onclick="nextSound()">Next ‚û°</button>
        </div>
    </div>
    
    <script>
        // ElevenLabs Configuration
        const ELEVENLABS_API_KEY = 'sk_65a1ba422c3245fc8cca3df62a85b603727e749448b7f252';
        const VOICE_ID = 'EXAVITQu4vr4xnSDxMaL'; // Female Russian voice
        
        let currentSoundIndex = 0;
        let isRecording = false;
        let recognition = null;
        
        const sounds = ['–ê', '–ö', '–ú', '–¢', '–û', '–ï'];
        
        // Custom audio files for pure sounds (you'll need to record these)
        const soundFiles = {
            '–ê': 'audio/a.mp3',
            '–ö': 'audio/k.mp3', 
            '–ú': 'audio/m.mp3',
            '–¢': 'audio/t.mp3',
            '–û': 'audio/o.mp3',
            '–ï': 'audio/e.mp3'
        };
        
        // Instructions in English
        const instructions = {
            '–ê': "Now try to repeat the Russian sound –ê",
            '–ö': "Listen and repeat the consonant –ö", 
            '–ú': "Practice the sound –ú",
            '–¢': "Try the sound –¢",
            '–û': "Repeat the vowel –û",
            '–ï': "Practice the sound –ï"
        };
        
        // Function to play instructions in English via ElevenLabs
        async function playInstruction(text) {
            try {
                const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${VOICE_ID}`, {
                    method: 'POST',
                    headers: {
                        'Accept': 'audio/mpeg',
                        'Content-Type': 'application/json',
                        'xi-api-key': ELEVENLABS_API_KEY
                    },
                    body: JSON.stringify({
                        text: text,
                        model_id: 'eleven_multilingual_v2',
                        voice_settings: {
                            stability: 0.6,
                            similarity_boost: 0.8,
                            style: 0.2,
                            use_speaker_boost: true
                        }
                    })
                });
                
                if (response.ok) {
                    const audioBlob = await response.blob();
                    const audioUrl = URL.createObjectURL(audioBlob);
                    const audio = new Audio(audioUrl);
                    audio.play();
                } else {
                    console.log('ElevenLabs unavailable, using fallback');
                    fallbackToWebSpeech(text);
                }
            } catch (error) {
                console.log('Error with ElevenLabs');
                fallbackToWebSpeech(text);
            }
        }
        
        // Fallback speech synthesis
        function fallbackToWebSpeech(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.8;
            window.speechSynthesis.speak(utterance);
        }
        
        // Play pure Russian sound (you'll need to record these files)
        function playRussianSound(sound) {
            // For now, using phonetic approximation via TTS
            // Replace with your recorded audio files later
            const phonetic = {
                '–ê': '–∞ah',
                '–ö': 'k k k',
                '–ú': 'mmm',
                '–¢': 't t t', 
                '–û': 'ooh',
                '–ï': 'ech'
            };
            
            const utterance = new SpeechSynthesisUtterance(phonetic[sound]);
            utterance.lang = 'ru-RU';
            utterance.rate = 0.6;
            utterance.pitch = 1.2;
            
            const voices = window.speechSynthesis.getVoices();
            const russianVoice = voices.find(voice => voice.lang.startsWith('ru'));
            if (russianVoice) {
                utterance.voice = russianVoice;
            }
            
            window.speechSynthesis.speak(utterance);
        }
        
        function playSound(sound) {
            // Visual feedback
            const cards = document.querySelectorAll('.sound-card');
            cards.forEach(card => card.classList.remove('active'));
            
            const targetCard = document.querySelector(`[data-sound="${sound}"]`);
            if (targetCard) {
                targetCard.classList.add('active');
                setTimeout(() => targetCard.classList.remove('active'), 2000);
            }
            
            // Update current sound
            currentSoundIndex = sounds.indexOf(sound);
            
            // Play instruction in English, then Russian sound
            playInstruction(instructions[sound]);
            
            setTimeout(() => {
                playRussianSound(sound);
            }, 2000);
        }
        
        function playCurrentSound() {
            if (currentSoundIndex >= 0 && currentSoundIndex < sounds.length) {
                const sound = sounds[currentSoundIndex];
                playRussianSound(sound);
            }
        }
        
        function nextSound() {
            currentSoundIndex = (currentSoundIndex + 1) % sounds.length;
            const sound = sounds[currentSoundIndex];
            playSound(sound);
        }
        
        function previousSound() {
            currentSoundIndex = currentSoundIndex > 0 ? currentSoundIndex - 1 : sounds.length - 1;
            const sound = sounds[currentSoundIndex];
            playSound(sound);
        }
        
        // Speech recognition setup
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'ru-RU';
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript.toUpperCase();
                    const targetSound = sounds[currentSoundIndex];
                    
                    document.getElementById('feedbackText').textContent = `You said: "${transcript}"`;
                    document.getElementById('feedback').classList.remove('hidden', 'error');
                    
                    if (transcript.includes(targetSound)) {
                        document.getElementById('feedback').classList.remove('error');
                        playInstruction("Excellent! Well done!");
                    } else {
                        document.getElementById('feedback').classList.add('error');
                        playInstruction("Try again. Listen carefully.");
                    }
                };
                
                recognition.onerror = function(event) {
                    document.getElementById('feedbackText').textContent = 'Could not recognize speech. Try again.';
                    document.getElementById('feedback').classList.remove('hidden');
                    document.getElementById('feedback').classList.add('error');
                };
                
                recognition.onend = function() {
                    isRecording = false;
                    document.getElementById('micBtn').classList.remove('recording');
                };
            }
        }
        
        function startRecording() {
            if (!recognition) {
                initSpeechRecognition();
            }
            
            if (!isRecording) {
                recognition.start();
                isRecording = true;
                document.getElementById('micBtn').classList.add('recording');
                document.getElementById('feedback').classList.add('hidden');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                document.getElementById('micBtn').innerHTML = '‚ùå';
                document.getElementById('micBtn').disabled = true;
            }
            
            // Start with first sound
            setTimeout(() => {
                playInstruction("Welcome to Russian phonetics! Let's start with the first sound.");
                setTimeout(() => {
                    playSound('–ê');
                }, 3000);
            }, 1000);
        });
    </script>
</body>
</html>
