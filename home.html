<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Russian Sounds Step by Step</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

```
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: white;
        padding: 20px;
    }
    
    .container { max-width: 800px; margin: 0 auto; }
    
    .lesson-card {
        background: rgba(255,255,255,0.95);
        color: #2c3e50;
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    
    .intro-section { text-align: center; padding: 20px; }
    .intro-text { font-size: 1.1em; line-height: 1.5; margin-bottom: 20px; }
    
    .letters-showcase {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    
    .letter-circle {
        width: 50px;
        height: 50px;
        background: #3498db;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5em;
        font-weight: bold;
    }
    
    .word-practice {
        display: flex;
        align-items: center;
        gap: 20px;
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
    }
    
    .word-image {
        width: 100px;
        height: 100px;
        background: #e74c3c;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3em;
        color: white;
        flex-shrink: 0;
    }
    
    .word-content { flex-grow: 1; }
    
    .word-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin: 15px 0;
    }
    
    .word-btn {
        background: #3498db;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 15px;
        cursor: pointer;
        font-size: 0.9em;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }
    
    .mic-icon {
        background: #e74c3c;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8em;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .mic-icon:hover {
        background: #c0392b;
        transform: scale(1.1);
    }
    
    .mic-icon.recording {
        background: #27ae60;
        animation: pulse 1s infinite;
    }
    
    .word-btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
    }
    
    .audio-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-top: 15px;
    }
    
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.9em;
        transition: all 0.3s;
    }
    
    .btn-play { background: #27ae60; color: white; }
    .btn-mic { background: #e74c3c; color: white; }
    .btn-mic.recording { background: #27ae60; animation: pulse 1s infinite; }
    .btn:hover { transform: translateY(-2px); }
    
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    
    .instruction { font-size: 0.9em; color: #7f8c8d; margin-bottom: 10px; }
    
    .feedback {
        background: #d4edda;
        color: #155724;
        padding: 10px;
        border-radius: 5px;
        margin-top: 15px;
        font-size: 0.9em;
    }
    
    .funny-comment {
        background: #e8f4fd;
        border-left: 4px solid #3498db;
        padding: 15px;
        margin: 15px 0;
        font-style: italic;
        border-radius: 5px;
    }
    
    .explanation-box {
        background: #fff3cd;
        border: 1px solid #ffeeba;
        border-radius: 8px;
        padding: 15px;
        margin: 20px 0;
    }
    
    .navigation {
        display: flex;
        justify-content: space-between;
        margin: 30px 0;
    }
    
    .nav-btn {
        background: #34495e;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .nav-btn:hover { background: #2c3e50; }
    .nav-btn:disabled { background: #95a5a6; cursor: not-allowed; }
    .hidden { display: none; }
    
    .stop-btn {
        background: #e74c3c;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 50%;
        cursor: pointer;
        margin-left: 10px;
    }
</style>
```

</head>
<body>
    <div class="container">
        <div id="intro" class="lesson-card">
            <div class="intro-section">
                <div class="intro-text">
                    Learning to read and write Russian is actually quite easy! We're going to start right now. 
                    Let's begin with a group of letters that look and sound pretty similar to the Latin alphabet.
                </div>
                <div class="letters-showcase">
                    <div class="letter-circle">Ğ</div>
                    <div class="letter-circle">Ğœ</div>
                    <div class="letter-circle">Ğš</div>
                    <div class="letter-circle">Ğ¢</div>
                    <div class="letter-circle">Ğ</div>
                    <div class="letter-circle">Ğ•</div>
                </div>
                <div class="audio-controls">
                    <button class="btn btn-play" onclick="playAllLetters()">Listen to all letters</button>
                    <button class="stop-btn" onclick="stopAllAudio()">â¹</button>
                </div>
            </div>
        </div>

```
    <div id="step-m" class="lesson-card hidden">
        <div class="instruction">Listen and repeat</div>
        <div class="word-practice">
            <div class="word-image">ğŸ‘©â€ğŸ‘§</div>
            <div class="word-content">
                <div class="word-group">
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ°')">ĞœĞ <span class="mic-icon" onclick="recordWord('Ğ¼Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ°Ğ¼Ğ°')">ĞœĞÌĞœĞ <span class="mic-icon" onclick="recordWord('Ğ¼Ğ°Ğ¼Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ°Ğ¼')">ĞĞœ <span class="mic-icon" onclick="recordWord('Ğ°Ğ¼', event)">ğŸ¤</span></span>
                </div>
                <div id="feedback-m" class="feedback hidden"></div>
            </div>
        </div>
        <div class="funny-comment">
            Congratulations! You just said your first Russian word - and it's probably the most important word in any language!
        </div>
    </div>

    <div id="step-k" class="lesson-card hidden">
        <div class="instruction">Listen and repeat</div>
        <div class="word-practice">
            <div class="word-image">ğŸ’</div>
            <div class="word-content">
                <div class="word-group">
                    <span class="word-btn" onclick="playWord('ĞºĞ°')">ĞšĞ <span class="mic-icon" onclick="recordWord('ĞºĞ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ°Ğº')">ĞĞš <span class="mic-icon" onclick="recordWord('Ğ°Ğº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ°Ğº')">ĞœĞĞš <span class="mic-icon" onclick="recordWord('Ğ¼Ğ°Ğº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ°Ğ¼')">ĞšĞĞœ <span class="mic-icon" onclick="recordWord('ĞºĞ°Ğ¼', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ°ĞºĞ°')">ĞšĞÌĞšĞ <span class="mic-icon" onclick="recordWord('ĞºĞ°ĞºĞ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ°ĞºĞ°ĞºĞ°')">ĞœĞĞšĞÌĞšĞ <span class="mic-icon" onclick="recordWord('Ğ¼Ğ°ĞºĞ°ĞºĞ°', event)">ğŸ¤</span></span>
                </div>
                <div id="feedback-k" class="feedback hidden"></div>
            </div>
        </div>
        <div class="funny-comment">
            Well, that escalated quickly! From "mama" to "monkey" in just a few sounds!
        </div>
    </div>

    <div id="step-o" class="lesson-card hidden">
        <div class="instruction">Listen and repeat</div>
        <div class="word-practice">
            <div class="word-image">ğŸ˜´</div>
            <div class="word-content">
                <div class="word-group">
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ¾')">ĞœĞ <span class="mic-icon" onclick="recordWord('Ğ¼Ğ¾', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ¾')">ĞšĞ <span class="mic-icon" onclick="recordWord('ĞºĞ¾', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¾Ğ¼')">ĞĞœ <span class="mic-icon" onclick="recordWord('Ğ¾Ğ¼', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¾Ğº')">ĞĞš <span class="mic-icon" onclick="recordWord('Ğ¾Ğº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ¾Ğº')">ĞœĞĞš <span class="mic-icon" onclick="recordWord('Ğ¼Ğ¾Ğº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ¾Ğ¼Ğ°')">ĞšĞÌĞœĞ <span class="mic-icon" onclick="recordWord('ĞºĞ¾Ğ¼Ğ°', event)">ğŸ¤</span></span>
                </div>
                <div id="feedback-o" class="feedback hidden"></div>
            </div>
        </div>
    </div>

    <div id="step-t" class="lesson-card hidden">
        <div class="instruction">Listen and repeat</div>
        <div class="word-practice">
            <div class="word-image">ğŸ±</div>
            <div class="word-content">
                <div class="word-group">
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ¾')">Ğ¢Ğ <span class="mic-icon" onclick="recordWord('Ñ‚Ğ¾', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ°')">Ğ¢Ğ <span class="mic-icon" onclick="recordWord('Ñ‚Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playRhythm('Ñ‚Ğ°-Ğ¢ĞÌ-Ñ‚Ğ°')">Ñ‚Ğ°-Ğ¢ĞÌ-Ñ‚Ğ° <span class="mic-icon" onclick="recordWord('Ñ‚Ğ°Ñ‚Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¾Ñ‚')">ĞĞ¢ <span class="mic-icon" onclick="recordWord('Ğ¾Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ°Ñ‚')">ĞĞ¢ <span class="mic-icon" onclick="recordWord('Ğ°Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ¾Ğ¼')">Ğ¢ĞĞœ <span class="mic-icon" onclick="recordWord('Ñ‚Ğ¾Ğ¼', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ¾Ñ‚')">ĞšĞĞ¢ <span class="mic-icon" onclick="recordWord('ĞºĞ¾Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼Ğ¾Ñ‚')">ĞœĞĞ¢ <span class="mic-icon" onclick="recordWord('Ğ¼Ğ¾Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ°Ğº')">Ğ¢ĞĞš <span class="mic-icon" onclick="recordWord('Ñ‚Ğ°Ğº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ°Ñ‚')">ĞšĞĞ¢ <span class="mic-icon" onclick="recordWord('ĞºĞ°Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ°Ñ‚Ğ¾Ğ¼')">ĞÌĞ¢ĞĞœ <span class="mic-icon" onclick="recordWord('Ğ°Ñ‚Ğ¾Ğ¼', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ°ĞºÑ‚')">Ğ¢ĞĞšĞ¢ <span class="mic-icon" onclick="recordWord('Ñ‚Ğ°ĞºÑ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğ¾Ğ¼Ğ°Ñ‚')">Ğ¢ĞĞœĞÌĞ¢ <span class="mic-icon" onclick="recordWord('Ñ‚Ğ¾Ğ¼Ğ°Ñ‚', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ°Ñ‚Ğ°ĞºĞ°')">ĞĞ¢ĞÌĞšĞ <span class="mic-icon" onclick="recordWord('Ğ°Ñ‚Ğ°ĞºĞ°', event)">ğŸ¤</span></span>
                </div>
                <div id="feedback-t" class="feedback hidden"></div>
            </div>
        </div>
    </div>

    <div id="step-e" class="lesson-card hidden">
        <div class="instruction">Listen and repeat</div>
        <div class="word-practice">
            <div class="word-image">â˜„ï¸</div>
            <div class="word-content">
                <div class="word-group">
                    <span class="word-btn" onclick="playWord('Ğ¼Ğµ')">ĞœĞ• <span class="mic-icon" onclick="recordWord('Ğ¼Ğµ', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚Ğµ')">Ğ¢Ğ• <span class="mic-icon" onclick="recordWord('Ñ‚Ğµ', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞµ')">ĞšĞ• <span class="mic-icon" onclick="recordWord('ĞºĞµ', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞµĞ¼')">Ğ•Ğœ <span class="mic-icon" onclick="recordWord('ĞµĞ¼', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞµĞº')">Ğ•Ğš <span class="mic-icon" onclick="recordWord('ĞµĞº', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼ĞµÑ‚Ğ°')">ĞœĞ•ÌĞ¢Ğ <span class="mic-icon" onclick="recordWord('Ğ¼ĞµÑ‚Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ñ‚ĞµĞ¼Ğ°')">Ğ¢Ğ•ÌĞœĞ <span class="mic-icon" onclick="recordWord('Ñ‚ĞµĞ¼Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('ĞºĞ¾Ğ¼ĞµÑ‚Ğ°')">ĞšĞĞœĞ•ÌĞ¢Ğ <span class="mic-icon" onclick="recordWord('ĞºĞ¾Ğ¼ĞµÑ‚Ğ°', event)">ğŸ¤</span></span>
                    <span class="word-btn" onclick="playWord('Ğ¼ĞµÑ‚ĞµĞ¾')">ĞœĞ•Ğ¢Ğ•ÌĞ <span class="mic-icon" onclick="recordWord('Ğ¼ĞµÑ‚ĞµĞ¾', event)">ğŸ¤</span></span>
                </div>
                <div id="feedback-e" class="feedback hidden"></div>
            </div>
        </div>
        <div class="explanation-box">
            Now you understand Russian rhythm! Each syllable can be stressed (loud and clear) or unstressed (quiet and short). 
            This rhythm pattern helps you speak Russian naturally!
        </div>
    </div>

    <div class="navigation">
        <button class="nav-btn" onclick="previousStep()" id="prevBtn">â† Previous</button>
        <button class="nav-btn" onclick="nextStep()" id="nextBtn">Next â†’</button>
    </div>
</div>

<script>
    const ELEVENLABS_API_KEY = 'sk_65a1ba422c3245fc8cca3df62a85b603727e749448b7f252';
    const VOICE_ID = 'EXAVITQu4vr4xnSDxMaL';
    
    const steps = ['intro', 'step-m', 'step-k', 'step-o', 'step-t', 'step-e'];
    let currentStep = 0;
    let currentAudio = null;
    let currentTimeout = null;
    let recognition = null;
    let waitingForRepeat = false;
    let currentWord = '';
    
    function stopAllAudio() {
        if (currentAudio) {
            currentAudio.pause();
            currentAudio.currentTime = 0;
            currentAudio = null;
        }
        if (window.speechSynthesis && window.speechSynthesis.speaking) {
            window.speechSynthesis.cancel();
        }
        if (currentTimeout) {
            clearTimeout(currentTimeout);
            currentTimeout = null;
        }
        document.querySelectorAll('.btn-mic').forEach(btn => {
            btn.classList.remove('recording');
        });
    }
    
    function showStep(index) {
        steps.forEach((step, i) => {
            const element = document.getElementById(step);
            if (element) {
                element.classList.toggle('hidden', i !== index);
            }
        });
        
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        if (prevBtn) prevBtn.disabled = index === 0;
        if (nextBtn) nextBtn.disabled = index === steps.length - 1;
    }
    
    function nextStep() {
        if (currentStep < steps.length - 1) {
            currentStep++;
            showStep(currentStep);
        }
    }
    
    function previousStep() {
        if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
        }
    }
    
    function playAllLetters() {
        stopAllAudio();
        alert('Play your recorded audio: all-letters.mp3 (Ğ Ğœ Ğš Ğ¢ Ğ Ğ•)');
    }
    
    function playWord(word) {
        stopAllAudio();
        alert(`Play your recorded audio: ${word}.mp3`);
    }
    
    function recordWord(word, event) {
        event.stopPropagation(); // Prevent word play when clicking microphone
        
        if (!recognition) {
            initSpeechRecognition();
        }
        
        currentWord = word;
        waitingForRepeat = false;
        
        // Add recording animation to this specific microphone
        const micIcon = event.target;
        micIcon.classList.add('recording');
        
        if (recognition) {
            try {
                recognition.start();
            } catch (e) {
                console.error('Recognition start error:', e);
                micIcon.classList.remove('recording');
            }
        }
    }
    
    function playRhythm(pattern) {
        stopAllAudio();
        let rhythmText = pattern.replace(/Ğ¢ĞÌ/g, 'TAH').replace(/Ñ‚Ğ°/g, 'tah');
        
        if (window.speechSynthesis) {
            const utterance = new SpeechSynthesisUtterance(rhythmText);
            utterance.lang = 'ru-RU';
            utterance.rate = 0.7;
            utterance.pitch = 1.2;
            
            const voices = window.speechSynthesis.getVoices();
            const russianVoice = voices.find(voice => voice.lang.startsWith('ru'));
            if (russianVoice) {
                utterance.voice = russianVoice;
            }
            
            window.speechSynthesis.speak(utterance);
        }
    }
    
    function initSpeechRecognition() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'ru-RU';
            
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript.toLowerCase();
                handleSpeechResult(transcript);
            };
            
            recognition.onend = function() {
                document.querySelectorAll('.btn-mic').forEach(btn => {
                    btn.classList.remove('recording');
                });
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                document.querySelectorAll('.btn-mic').forEach(btn => {
                    btn.classList.remove('recording');
                });
            };
        }
    }
    
    function handleSpeechResult(transcript) {
        const feedback = document.getElementById(`feedback-${currentWord}`);
        
        if (!feedback) {
            console.error(`Feedback element not found: feedback-${currentWord}`);
            return;
        }
        
        if (waitingForRepeat) {
            feedback.textContent = 'ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†!';
            feedback.classList.remove('hidden');
            playEnglishText('ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†!');
            waitingForRepeat = false;
            return;
        }
        
        feedback.textContent = `You said: "${transcript}"`;
        feedback.classList.remove('hidden');
        
        currentTimeout = setTimeout(() => {
            feedback.textContent = 'Now listen to the correct pronunciation:';
            currentTimeout = setTimeout(() => {
                alert(`Play correct pronunciation: ${currentWord}.mp3`);
                currentTimeout = setTimeout(() => {
                    feedback.textContent = 'Please try again - repeat after me:';
                    waitingForRepeat = true;
                    playEnglishText('Please try again - repeat after me');
                }, 3000);
            }, 1000);
        }, 2000);
    }
    
    async function playEnglishText(text) {
        stopAllAudio();
        try {
            const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${VOICE_ID}`, {
                method: 'POST',
                headers: {
                    'Accept': 'audio/mpeg',
                    'Content-Type': 'application/json',
                    'xi-api-key': ELEVENLABS_API_KEY
                },
                body: JSON.stringify({
                    text: text,
                    model_id: 'eleven_multilingual_v2',
                    voice_settings: {
                        stability: 0.7,
                        similarity_boost: 0.8,
                        style: 0.2,
                        use_speaker_boost: true
                    }
                })
            });
            
            if (response.ok) {
                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                currentAudio = new Audio(audioUrl);
                currentAudio.play();
            } else {
                console.error('ElevenLabs error:', response.status);
                fallbackEnglishSpeech(text);
            }
        } catch (error) {
            console.error('ElevenLabs fetch error:', error);
            fallbackEnglishSpeech(text);
        }
    }
    
    function fallbackEnglishSpeech(text) {
        if (window.speechSynthesis) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.8;
            window.speechSynthesis.speak(utterance);
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        showStep(0);
    });
</script>
```

</body>
</html>
